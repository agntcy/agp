{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ClientConfig",
  "description": "Struct for the client configuration. This struct contains the endpoint, origin, compression type, rate limit, TLS settings, keepalive settings, timeout settings, buffer size settings, headers, and auth settings. The client configuration can be converted to a tonic channel.",
  "type": "object",
  "required": [
    "endpoint"
  ],
  "properties": {
    "auth": {
      "description": "Auth configuration for outgoing RPCs.",
      "allOf": [
        {
          "$ref": "#/definitions/AuthenticationConfig"
        }
      ]
    },
    "buffer_size": {
      "description": "ReadBufferSize.",
      "type": [
        "integer",
        "null"
      ],
      "format": "uint",
      "minimum": 0.0
    },
    "compression": {
      "description": "Compression type - TODO(msardara): not implemented yet.",
      "anyOf": [
        {
          "$ref": "#/definitions/CompressionType"
        },
        {
          "type": "null"
        }
      ]
    },
    "connect_timeout": {
      "description": "Timeout for the connection.",
      "default": {
        "nanos": 0,
        "secs": 10
      },
      "type": "string"
    },
    "endpoint": {
      "description": "The target the client will connect to.",
      "type": "string"
    },
    "headers": {
      "description": "The headers associated with gRPC requests.",
      "default": {},
      "type": "object",
      "additionalProperties": {
        "type": "string"
      }
    },
    "keepalive": {
      "description": "Keepalive parameters.",
      "anyOf": [
        {
          "$ref": "#/definitions/KeepaliveConfig"
        },
        {
          "type": "null"
        }
      ]
    },
    "origin": {
      "description": "Origin for the client.",
      "type": [
        "string",
        "null"
      ]
    },
    "rate_limit": {
      "description": "Rate Limits",
      "type": [
        "string",
        "null"
      ]
    },
    "request_timeout": {
      "description": "Timeout per request.",
      "default": {
        "nanos": 0,
        "secs": 30
      },
      "type": "string"
    },
    "tls": {
      "description": "TLS client configuration.",
      "allOf": [
        {
          "$ref": "#/definitions/TLSSetting"
        }
      ]
    }
  },
  "definitions": {
    "AuthenticationConfig": {
      "description": "Enum holding one configuration for the client.",
      "oneOf": [
        {
          "description": "Basic authentication configuration.",
          "type": "object",
          "required": [
            "basic"
          ],
          "properties": {
            "basic": {
              "$ref": "#/definitions/BasicAuthenticationConfig"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "Bearer authentication configuration.",
          "type": "object",
          "required": [
            "bearer"
          ],
          "properties": {
            "bearer": {
              "$ref": "#/definitions/BearerAuthenticationConfig"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "JWT authentication configuration.",
          "type": "object",
          "required": [
            "jwt"
          ],
          "properties": {
            "jwt": {
              "$ref": "#/definitions/JwtAuthenticationConfig"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "None",
          "type": "string",
          "enum": [
            "none"
          ]
        }
      ]
    },
    "BasicAuthenticationConfig": {
      "type": "object",
      "required": [
        "password",
        "username"
      ],
      "properties": {
        "password": {
          "description": "Origin for the client.",
          "allOf": [
            {
              "$ref": "#/definitions/OpaqueString"
            }
          ]
        },
        "username": {
          "description": "The target the client will connect to.",
          "type": "string"
        }
      }
    },
    "BearerAuthenticationConfig": {
      "type": "object",
      "required": [
        "token"
      ],
      "properties": {
        "token": {
          "$ref": "#/definitions/OpaqueString"
        }
      }
    },
    "Claims": {
      "type": "object",
      "properties": {
        "audience": {
          "description": "JWT audience",
          "type": [
            "string",
            "null"
          ]
        },
        "custom_claims": {
          "type": [
            "object",
            "null"
          ],
          "additionalProperties": true
        },
        "issuer": {
          "description": "JWT Issuer",
          "type": [
            "string",
            "null"
          ]
        },
        "subject": {
          "description": "JWT Subject",
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "CompressionType": {
      "type": "string",
      "enum": [
        "Gzip",
        "Zlib",
        "Deflate",
        "Snappy",
        "Zstd",
        "Lz4",
        "None",
        "Empty"
      ]
    },
    "JwtAuthenticationConfig": {
      "type": "object",
      "required": [
        "key"
      ],
      "properties": {
        "claims": {
          "description": "Claims",
          "allOf": [
            {
              "$ref": "#/definitions/Claims"
            }
          ]
        },
        "duration": {
          "description": "JWT Duration (will become exp: now() + duration)",
          "default": {
            "nanos": 0,
            "secs": 3600
          },
          "type": "string"
        },
        "key": {
          "description": "One of: `encoding`, `decoding`, or `autoresolve` Encoding key is used for signing JWTs (client-side). Decoding key is used for verifying JWTs (server-side). Autoresolve is used to automatically resolve the key based on the claims.",
          "allOf": [
            {
              "$ref": "#/definitions/JwtKey"
            }
          ]
        }
      }
    },
    "JwtKey": {
      "oneOf": [
        {
          "type": "object",
          "required": [
            "encoding"
          ],
          "properties": {
            "encoding": {
              "$ref": "#/definitions/Key"
            }
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "required": [
            "decoding"
          ],
          "properties": {
            "decoding": {
              "$ref": "#/definitions/Key"
            }
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "required": [
            "autoresolve"
          ],
          "properties": {
            "autoresolve": {
              "type": "boolean"
            }
          },
          "additionalProperties": false
        }
      ]
    },
    "KeepaliveConfig": {
      "description": "Keepalive configuration for the client. This struct contains the keepalive time for TCP and HTTP2, the timeout duration for the keepalive, and whether to permit keepalive without an active stream.",
      "type": "object",
      "properties": {
        "http2_keepalive": {
          "description": "The duration of the keepalive time for HTTP2",
          "default": {
            "nanos": 0,
            "secs": 7200
          },
          "type": "string"
        },
        "keep_alive_while_idle": {
          "description": "Whether to permit keepalive without an active stream",
          "default": false,
          "type": "boolean"
        },
        "tcp_keepalive": {
          "description": "The duration of the keepalive time for TCP",
          "default": {
            "nanos": 0,
            "secs": 7200
          },
          "type": "string"
        },
        "timeout": {
          "description": "The timeout duration for the keepalive",
          "default": {
            "nanos": 0,
            "secs": 20
          },
          "type": "string"
        }
      }
    },
    "Key": {
      "description": "Represents a key",
      "type": "object",
      "oneOf": [
        {
          "description": "PEM encoded key",
          "type": "object",
          "required": [
            "pem"
          ],
          "properties": {
            "pem": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "File path to the key",
          "type": "object",
          "required": [
            "file"
          ],
          "properties": {
            "file": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      ]
    },
    "OpaqueString": {
      "type": "string"
    },
    "TLSSetting": {
      "type": "object",
      "required": [
        "reload_interval"
      ],
      "properties": {
        "ca_file": {
          "description": "Path to the CA cert. For a client this verifies the server certificate. For a server this verifies client certificates. If empty uses system root CA. (optional)",
          "type": [
            "string",
            "null"
          ]
        },
        "ca_pem": {
          "description": "In memory PEM encoded cert. (optional)",
          "type": [
            "string",
            "null"
          ]
        },
        "cert_file": {
          "description": "Path to the TLS cert to use for TLS required connections. (optional)",
          "type": [
            "string",
            "null"
          ]
        },
        "cert_pem": {
          "description": "In memory PEM encoded TLS cert to use for TLS required connections. (optional)",
          "type": [
            "string",
            "null"
          ]
        },
        "include_system_ca_certs_pool": {
          "description": "If true, load system CA certificates pool in addition to the certificates configured in this struct.",
          "default": false,
          "type": "boolean"
        },
        "insecure": {
          "description": "In gRPC and HTTP when set to true, this is used to disable the client transport security. (optional, default false)",
          "default": false,
          "type": "boolean"
        },
        "insecure_skip_verify": {
          "description": "InsecureSkipVerify will enable TLS but not verify the server certificate.",
          "default": false,
          "type": "boolean"
        },
        "key_file": {
          "description": "Path to the TLS key to use for TLS required connections. (optional)",
          "type": [
            "string",
            "null"
          ]
        },
        "key_pem": {
          "description": "In memory PEM encoded TLS key to use for TLS required connections. (optional)",
          "type": [
            "string",
            "null"
          ]
        },
        "reload_interval": {
          "description": "ReloadInterval specifies the duration after which the certificate will be reloaded If not set, it will never be reloaded",
          "type": "string"
        },
        "tls_version": {
          "description": "The TLS version to use. If not set, the default is \"tls1.3\". The value must be either \"tls1.2\" or \"tls1.3\". (optional)",
          "default": "tls1.3",
          "type": "string"
        }
      }
    }
  }
}